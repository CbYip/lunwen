{include file="public/header"}
{include file="public/left"}
<div class="tpl-content-wrapper">
    <div class="tpl-content-page-title">
        论文订单列表
    </div>
    <ol class="am-breadcrumb">
        <li><a href="/admin.php" class="am-icon-home">首页</a></li>
        <li class="am-active">论文订单列表</li>
    </ol>
    <div class="tpl-portlet-components">
        <div class="portlet-title">
            <div class="caption font-green bold">
                <span class="am-icon-code"></span> 列表
            </div>
        </div>
        <div class="tpl-block">
            <div>
                <div class="am-u-sm-12 am-u-md-2">
                    <div class="am-form-group">
                        <select id="selectType">
                            <option value="0">所有类别</option>
                            <option value="1">文稿代写</option>
                            <option value="2">期刊发表</option>
                            <option value="3">论文修改</option>
                            <option value="4">包写包发</option>
                        </select>
                    </div>
                </div>
                <div class="am-u-sm-12 am-u-md-2">
                    <div class="am-form-group">
                        <select id="orderType">
                            <option value="a">订单状态</option>
                            <option value="0">已付款</option>
                            <option value="1">未付款</option>
                            <option value="2">待审核</option>
                        </select>
                    </div>
                </div>
                <div id="nav"></div>
            </div>
            <div class="am-g">
                <div class="am-u-sm-12">
                    <form class="am-form">
                        <table class="am-table am-table-striped am-table-hover table-main">
                            <thead>
                            <tr>
                                <th class="table-check"><input type="checkbox" class="tpl-table-fz-check"></th>
                                <th class="table-id">ID</th>
                                <th class="table-order">订单号</th>
                                <th class="table-title">题目</th>
                                <th class="table-type">订单类型</th>
                                <th class="table-complete">项目进度</th>
                                <th class="table-author am-hide-sm-only">姓名</th>
                                <th class="table-tel">电话</th>
                                <th class="table-email">邮箱</th>
                                <th class="table-nickname">微信名</th>
                                <th class="table-price">金额</th>
                                <th class="table-flag">订单状态</th>
                                <th class="table-date am-hide-sm-only">完成日期</th>
                                <th class="table-set">操作</th>
                            </tr>
                            </thead>
                            <tbody class="or">
                            <?php
                                  $i=1;
                                ?>
                            {volist name="order" id="vo"}
                            <tr>
                                <td><input type="checkbox"></td>
                                <td><?php echo $i;?></td>
                                <td class="order"><a href="{:url('table/order_list_detail',['order' => $vo.order])}">{$vo.order}</a></td>
                                <td>{$vo.title}</td>
                                {if condition="$vo.service eq 1"}
                                <td>文稿代写</td>
                                    {if condition="$vo.complete eq 0"}
                                    <td>项目未开工</td>
                                    {elseif condition="$vo.complete eq 1"/}
                                    <td>项目开工</td>
                                    {elseif condition="$vo.complete eq 2"/}
                                    <td>完成初稿</td>
                                    {elseif condition="$vo.complete eq 3"/}
                                    <td>修改反馈</td>
                                    {else/}
                                    <td>项目完成</td>
                                    {/if}
                                {elseif condition="$vo.service eq 2"/}
                                <td>期刊发表</td>
                                    {if condition="$vo.complete eq 0"}
                                    <td>稿件未送审</td>
                                    {elseif condition="$vo.complete eq 1"/}
                                    <td>稿件送审中</td>
                                    {elseif condition="$vo.complete eq 2"/}
                                    <td>稿件已录用</td>
                                    {elseif condition="$vo.complete eq 3"/}
                                    <td>稿件待出刊</td>
                                    {elseif condition="$vo.complete eq 4"/}
                                    <td>稿件已出刊</td>
                                    {elseif condition="$vo.complete eq 5"/}
                                    <td>稿件返修</td>
                                    {else/}
                                    <td>退稿</td>
                                    {/if}
                                {elseif condition="$vo.service eq 3"/}
                                <td>论文修改</td>
                                    {if condition="$vo.complete eq 0"}
                                    <td>项目未开工</td>
                                    {elseif condition="$vo.complete eq 1"/}
                                    <td>项目开工</td>
                                    {elseif condition="$vo.complete eq 2"/}
                                    <td>完成初稿</td>
                                    {elseif condition="$vo.complete eq 3"/}
                                    <td>修改反馈</td>
                                    {else/}
                                    <td>项目完成</td>
                                    {/if}
                                {elseif condition="$vo.service eq 4"/}
                                <td>包写包发</td>
                                    {if condition="$vo.complete eq 0"}
                                    <td>项目未开工</td>
                                    {elseif condition="$vo.complete eq 1"/}
                                    <td>稿件写作中</td>
                                    {elseif condition="$vo.complete eq 2"/}
                                    <td>稿件完成</td>
                                    {elseif condition="$vo.complete eq 3"/}
                                    <td>稿件送审中</td>
                                    {elseif condition="$vo.complete eq 4"/}
                                    <td>稿件已录用</td>
                                    {elseif condition="$vo.complete eq 5"/}
                                    <td>稿件待出刊</td>
                                    {else/}
                                    <td>稿件已出刊</td>
                                    {/if}
                                {/if}
                                <td class="am-hide-sm-only">{$vo.username}</td>
                                <td>{$vo.usertel}</td>
                                <td>{$vo.email}</td>
                                <td>{$vo.nickname}</td>
                                <td class="am-hide-sm-only">{$vo.price}</td>
                                    {if condition="$vo.flag eq 0"}
                                    <td class="shenhe">已付款</td>
                                    {elseif condition="$vo.flag eq 1"/}
                                    <td class="shenhe">未付款</td>
                                    {else/}
                                    <td class="shenhe">待审核</td>
                                {/if}
                                {if condition="($vo.service eq 2) or ($vo.service eq 4)"}
                                <td>{$vo.fatime}</td>
                                {else/}
                                <td>{$vo.ctime}</td>
                                {/if}
                                <td>
                                    <div class="am-btn-toolbar">
                                        <div class="am-btn-group am-btn-group-xs">
                                            <button type="button" class="am-btn am-btn-default am-btn-xs am-text-secondary edit"><span class="am-icon-pencil-square-o"></span> 编辑</button>
                                            <button type="button" class="am-btn am-btn-default am-btn-xs am-text-success pay"><span class="am-icon-cny"></span>付款</button>
                                            <button type="button" class="am-btn am-btn-default am-btn-xs am-text-warning check"><span class="am-icon-check"></span>审核</button>
                                            {if condition="($vo.service eq 1) or ($vo.service eq 3)"}
                                            <div class="am-dropdown" data-am-dropdown>
                                                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-primary am-dropdown-toggle" data-am-dropdown-toggle>
                                                    <span class="am-icon-caret-down"></span>项目进度
                                                </button>
                                                <ul class="am-dropdown-content">
                                                    <li><a href="javascript;" class="schedule1" value="0" onclick="return false">项目未开工</a></li>
                                                    <li><a href="javascript;" class="schedule1" value="1" onclick="return false">项目开工</a></li>
                                                    <li><a href="javascript;" class="schedule1" value="2" onclick="return false">完成初稿</a></li>
                                                    <li><a href="javascript;" class="schedule1" value="3" onclick="return false">修改反馈</a></li>
                                                    <li><a href="javascript;" class="schedule1" value="4" onclick="return false">项目完成</a></li>
                                                </ul>
                                            </div>
                                            {elseif condition="$vo.service eq 2"}
                                            <div class="am-dropdown" data-am-dropdown>
                                                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-primary am-dropdown-toggle" data-am-dropdown-toggle>
                                                    <span class="am-icon-caret-down"></span>项目进度
                                                </button>
                                                <ul class="am-dropdown-content">
                                                    <li><a href="javascript;" class="schedule2" value="0" onclick="return false">稿件未送审</a></li>
                                                    <li><a href="javascript;" class="schedule2" value="1" onclick="return false">稿件送审中</a></li>
                                                    <li><a href="javascript;" class="schedule2" value="2" onclick="return false">稿件已录用</a></li>
                                                    <li><a href="javascript;" class="schedule2" value="3" onclick="return false">稿件待出刊</a></li>
                                                    <li><a href="javascript;" class="schedule2" value="4" onclick="return false">稿件已出刊</a></li>
                                                    <li><a href="javascript;" class="schedule2" value="5" onclick="return false">稿件返修</a></li>
                                                    <li><a href="javascript;" class="schedule2" value="6" onclick="return false">退稿</a></li>
                                                </ul>
                                            </div>
                                            {else/}
                                            <div class="am-dropdown" data-am-dropdown>
                                                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-primary am-dropdown-toggle" data-am-dropdown-toggle>
                                                    <span class="am-icon-caret-down"></span>项目进度
                                                </button>
                                                <ul class="am-dropdown-content">
                                                    <li><a href="javascript;" class="schedule3" value="0" onclick="return false">项目未开工</a></li>
                                                    <li><a href="javascript;" class="schedule3" value="1" onclick="return false">稿件写作中</a></li>
                                                    <li><a href="javascript;" class="schedule3" value="2" onclick="return false">稿件完成</a></li>
                                                    <li><a href="javascript;" class="schedule3" value="3" onclick="return false">稿件送审中</a></li>
                                                    <li><a href="javascript;" class="schedule3" value="4" onclick="return false">稿件已录用</a></li>
                                                    <li><a href="javascript;" class="schedule3" value="5" onclick="return false">稿件待出刊</a></li>
                                                    <li><a href="javascript;" class="schedule3" value="6" onclick="return false">稿件已出刊</a></li>
                                                </ul>
                                            </div>
                                            {/if}
                                            <button type="button" class="am-btn am-btn-default am-btn-xs am-text-danger  delete"><span class="am-icon-trash-o"></span> 删除</button>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            {/volist}
                            </tbody>
                        </table>
                        <div class="am-cf">
                            <div class="am-fr">
                                {$order->render()}
                            </div>
                        </div>
                        <hr>
                    </form>
                </div>

            </div>
        </div>
        <div class="tpl-alert"></div>
    </div>
    <script type="text/javascript">
        //分类筛选
        $('#selectType').change(function () {
            var id = $('#selectType').val();
            var result = "";
            $("#nav").empty();
            if(id == "1" || id == "3"){
                result = '<div class="am-u-sm-12 am-u-md-2">\n' +
                    '                    <div class="am-form-group">\n' +
                    '                        <select id="rateType">\n' +
                    '                            <option value="b">项目进度</option>\n' +
                    '                            <option value="0">项目未开工</option>\n' +
                    '                            <option value="1">项目开工</option>\n' +
                    '                            <option value="2">完成初稿</option>\n' +
                    '                            <option value="3">修改反馈</option>\n' +
                    '                            <option value="4">项目完成</option>\n' +
                    '                        </select>\n' +
                    '                    </div>\n' +
                    '                </div>';
            }else if(id == "2"){
                result = '<div class="am-u-sm-12 am-u-md-2">\n' +
                    '                    <div class="am-form-group">\n' +
                    '                        <select id="rateType">\n' +
                    '                            <option value="b">项目进度</option>\n' +
                    '                            <option value="0">稿件未送审</option>\n' +
                    '                            <option value="1">稿件送审中</option>\n' +
                    '                            <option value="2">稿件已录用</option>\n' +
                    '                            <option value="3">稿件待出刊</option>\n' +
                    '                            <option value="4">稿件已出刊</option>\n' +
                    '                            <option value="5">稿件返修</option>\n' +
                    '                            <option value="6">退稿</option>\n' +
                    '                        </select>\n' +
                    '                    </div>\n' +
                    '                </div>';
            }else if(id == "4"){
                result = '<div class="am-u-sm-12 am-u-md-2">\n' +
                    '                    <div class="am-form-group">\n' +
                    '                        <select id="rateType">\n' +
                    '                            <option value="b">项目进度</option>\n' +
                    '                            <option value="0">项目未开工</option>\n' +
                    '                            <option value="1">稿件写作中</option>\n' +
                    '                            <option value="2">稿件完成</option>\n' +
                    '                            <option value="3">稿件送审中</option>\n' +
                    '                            <option value="4">稿件已录用</option>\n' +
                    '                            <option value="5">稿件待出刊</option>\n' +
                    '                            <option value="6">稿件已出刊</option>\n' +
                    '                        </select>\n' +
                    '                    </div>\n' +
                    '                </div>';
            }
            $("#nav").append(result);
            var oid = $('#orderType').val();
            var rid = $('#rateType').val();
            $.ajax({
                type: "POST",
                url: "{:url('table/order_list')}",
                data: {"id":id, "oid":oid, "rid":rid},
                dataType: "json",
                success:function (data) {
                    var json = eval(data);
                    var content = "";
                    $(".or").empty();
                    $(".am-cf").empty();
                    for(var i=0;i<json.length;i++){
                        b = i + 1;
                        content +=
                            '<tr>' +
                            '<td><input type="checkbox"></td>' +
                            '<td>' + b + '</td>' +
                            '<td class="order"><a href="{:url(\'table/order_list_detail\',[\'order\' => $vo.order])}">' + json[i].order +'</a></td>' +
                            '<td>' + json[i].title + '</td>';
                        if(json[i].service == "1"){
                            content += '<td>文稿代写</td>';
                            if(json[i].complete == "0"){
                                content += '<td>项目未开工</td>\n';
                            }else if(json[i].complete == "1"){
                                content += '<td>项目开工</td>\n';
                            }else if(json[i].complete == "2"){
                                content += '<td>完成初稿</td>\n';
                            }else if(json[i].complete == "3"){
                                content += '<td>修改反馈</td>\n';
                            }else{
                                content += '<td>项目完成</td>\n';
                            }
                        }else if(json[i].service == "2"){
                            content += '<td>期刊发表</td>';
                            if(json[i].complete == "0"){
                                content += '<td>稿件未送审</td>\n';
                            }else if(json[i].complete == "1"){
                                content += '<td>稿件送审中</td>\n';
                            }else if(json[i].complete == "2"){
                                content += '<td>稿件已录用</td>\n';
                            }else if(json[i].complete == "3"){
                                content += '<td>稿件待出刊</td>\n';
                            }else if(json[i].complete == "4"){
                                content += '<td>稿件已出刊</td>\n';
                            }else if(json[i].complete == "5"){
                                content += '<td>稿件返修</td>\n';
                            }else{
                                content += '<td>退稿</td>\n';
                            }
                        }else if(json[i].service == "3"){
                            content += '<td>论文修改</td>';
                            if(json[i].complete == "0"){
                                content += '<td>项目未开工</td>\n';
                            }else if(json[i].complete == "1"){
                                content += '<td>项目开工</td>\n';
                            }else if(json[i].complete == "2"){
                                content += '<td>完成初稿</td>\n';
                            }else if(json[i].complete == "3"){
                                content += '<td>修改反馈</td>\n';
                            }else{
                                content += '<td>项目完成</td>\n';
                            }
                        }else{
                            content += '<td>包写包发</td>';
                            if(json[i].complete == "0"){
                                content += '<td>项目未开工</td>\n';
                            }else if(json[i].complete == "1"){
                                content += '<td>稿件写作中</td>\n';
                            }else if(json[i].complete == "2"){
                                content += '<td>稿件完成</td>\n';
                            }else if(json[i].complete == "3"){
                                content += '<td>稿件送审中</td>\n';
                            }else if(json[i].complete == "4"){
                                content += '<td>稿件已录用</td>\n';
                            }else if(json[i].complete == "5"){
                                content += '<td>稿件待出刊</td>\n';
                            }else{
                                content += '<td>稿件已出刊</td>\n';
                            }
                        }
                        content += '<td class="am-hide-sm-only">' + json[i].username +'</td>' +
                            '<td>' + json[i].usertel + '</td>' +
                            '<td class="am-hide-sm-only">' + json[i].price + '</td>';
                        if(json[i].flag == "0"){
                            content += '<td class="shenhe">已付款</td>';
                        }else if(json[i].flag == "1"){
                            content += '<td class="shenhe">未付款</td>';
                        }else{
                            content += '<td class="shenhe">待审核</td>';
                        }

                        if(json[i].service == "2" || json[i].service == "4"){
                            content += '<td>' + json[i].fatime + '</td>';
                        }else{
                            content += '<td>' + json[i].ctime + '</td>';
                        }
                        if(json[i].service == "1" || json[i].service == "3"){
                            content += '<td>\n' +
                                '        <div class="am-btn-toolbar">\n' +
                                '            <div class="am-btn-group am-btn-group-xs">\n' +
                                '                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-secondary edit"><span class="am-icon-pencil-square-o"></span> 编辑</button>\n' +
                                '                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-success pay"><span class="am-icon-cny"></span>付款</button>\n' +
                                '                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-warning check"><span class="am-icon-check"></span>审核</button>\n' +
                                '                <div class="am-dropdown doc-dropdown-js">\n' +
                                '                                                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-primary am-dropdown-toggle" data-am-dropdown-toggle>\n' +
                                '                                                    <span class="am-icon-caret-down"></span>项目进度\n' +
                                '                                                </button>\n' +
                                '                                                <ul class="am-dropdown-content">\n' +
                                '                                                    <li><a href="javascript;" class="schedule1" value="0" onclick="return false">项目未开工</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule1" value="1" onclick="return false">项目开工</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule1" value="2" onclick="return false">完成初稿</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule1" value="3" onclick="return false">修改反馈</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule1" value="4" onclick="return false">项目完成</a></li>\n' +
                                '                                                </ul>\n' +
                                '                                            </div>\n' +
                                '                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-danger  delete"><span class="am-icon-trash-o"></span> 删除</button>\n' +
                                '            </div>\n' +
                                '        </div>\n' +
                                '    </td>' +
                                '</tr>';
                        }else if(json.service == "2"){
                            content += '<td>\n' +
                                '        <div class="am-btn-toolbar">\n' +
                                '            <div class="am-btn-group am-btn-group-xs">\n' +
                                '                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-secondary edit"><span class="am-icon-pencil-square-o"></span> 编辑</button>\n' +
                                '                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-success pay"><span class="am-icon-cny"></span>付款</button>\n' +
                                '                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-warning check"><span class="am-icon-check"></span>审核</button>\n' +
                                '                <div class="am-dropdown doc-dropdown-js">\n' +
                                '                                                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-primary am-dropdown-toggle" data-am-dropdown-toggle>\n' +
                                '                                                    <span class="am-icon-caret-down"></span>项目进度\n' +
                                '                                                </button>\n' +
                                '                                                <ul class="am-dropdown-content">\n' +
                                '                                                    <li><a href="javascript;" class="schedule2" value="0" onclick="return false">稿件未送审</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule2" value="1" onclick="return false">稿件送审中</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule2" value="2" onclick="return false">稿件已录用</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule2" value="3" onclick="return false">稿件待出刊</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule2" value="4" onclick="return false">稿件已出刊</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule2" value="5" onclick="return false">稿件返修</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule2" value="6" onclick="return false">退稿</a></li>\n' +
                                '                                                </ul>\n' +
                                '                                            </div>\n'+
                                '                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-danger  delete"><span class="am-icon-trash-o"></span> 删除</button>\n' +
                                '            </div>\n' +
                                '        </div>\n' +
                                '    </td>' +
                                '</tr>';
                        }else{
                            content += '<td>\n' +
                                '        <div class="am-btn-toolbar">\n' +
                                '            <div class="am-btn-group am-btn-group-xs">\n' +
                                '                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-secondary edit"><span class="am-icon-pencil-square-o"></span> 编辑</button>\n' +
                                '                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-success pay"><span class="am-icon-cny"></span>付款</button>\n' +
                                '                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-warning check"><span class="am-icon-check"></span>审核</button>\n' +
                                '                <div class="am-dropdown doc-dropdown-js">\n' +
                                '                                                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-primary am-dropdown-toggle" data-am-dropdown-toggle>\n' +
                                '                                                    <span class="am-icon-caret-down"></span>项目进度\n' +
                                '                                                </button>\n' +
                                '                                                <ul class="am-dropdown-content">\n' +
                                '                                                    <li><a href="javascript;" class="schedule3" value="0" onclick="return false">项目未开工</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule3" value="1" onclick="return false">稿件写作中</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule3" value="2" onclick="return false">稿件完成</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule3" value="3" onclick="return false">稿件送审中</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule3" value="4" onclick="return false">稿件已录用</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule3" value="5" onclick="return false">稿件待出刊</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule3" value="6" onclick="return false">稿件已出刊</a></li>\n' +
                                '                                                </ul>\n' +
                                '                                            </div>\n'+
                                '                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-danger  delete"><span class="am-icon-trash-o"></span> 删除</button>\n' +
                                '            </div>\n' +
                                '        </div>\n' +
                                '    </td>' +
                                '</tr>';
                        }
                    }
                    $(".or").append(content);
                    $('.doc-dropdown-js').dropdown({justify: '.doc-dropdown-justify-js'});
                }
            })
        })
        $('#orderType').change(function () {
            var id = $('#selectType').val();
            var oid = $('#orderType').val();
            var rid = $('#rateType').val();
            $.ajax({
                type: "POST",
                url: "{:url('table/order_list')}",
                data: {"id":id, "oid":oid, "rid":rid},
                dataType: "json",
                success:function (data) {
                    var json = eval(data);
                    var content = "";
                    $(".or").empty();
                    $(".am-cf").empty();
                    for(var i=0;i<json.length;i++){
                        b = i + 1;
                        content +=
                            '<tr>' +
                            '<td><input type="checkbox"></td>' +
                            '<td>' + b + '</td>' +
                            '<td class="order"><a href="{:url(\'table/order_list_detail\',[\'order\' => $vo.order])}">' + json[i].order +'</a></td>' +
                            '<td>' + json[i].title + '</td>';
                        if(json[i].service == "1"){
                            content += '<td>文稿代写</td>';
                            if(json[i].complete == "0"){
                                content += '<td>项目未开工</td>\n';
                            }else if(json[i].complete == "1"){
                                content += '<td>项目开工</td>\n';
                            }else if(json[i].complete == "2"){
                                content += '<td>完成初稿</td>\n';
                            }else if(json[i].complete == "3"){
                                content += '<td>修改反馈</td>\n';
                            }else{
                                content += '<td>项目完成</td>\n';
                            }
                        }else if(json[i].service == "2"){
                            content += '<td>期刊发表</td>';
                            if(json[i].complete == "0"){
                                content += '<td>稿件未送审</td>\n';
                            }else if(json[i].complete == "1"){
                                content += '<td>稿件送审中</td>\n';
                            }else if(json[i].complete == "2"){
                                content += '<td>稿件已录用</td>\n';
                            }else if(json[i].complete == "3"){
                                content += '<td>稿件待出刊</td>\n';
                            }else if(json[i].complete == "4"){
                                content += '<td>稿件已出刊</td>\n';
                            }else if(json[i].complete == "5"){
                                content += '<td>稿件返修</td>\n';
                            }else{
                                content += '<td>退稿</td>\n';
                            }
                        }else if(json[i].service == "3"){
                            content += '<td>论文修改</td>';
                            if(json[i].complete == "0"){
                                content += '<td>项目未开工</td>\n';
                            }else if(json[i].complete == "1"){
                                content += '<td>项目开工</td>\n';
                            }else if(json[i].complete == "2"){
                                content += '<td>完成初稿</td>\n';
                            }else if(json[i].complete == "3"){
                                content += '<td>修改反馈</td>\n';
                            }else{
                                content += '<td>项目完成</td>\n';
                            }
                        }else{
                            content += '<td>包写包发</td>';
                            if(json[i].complete == "0"){
                                content += '<td>项目未开工</td>\n';
                            }else if(json[i].complete == "1"){
                                content += '<td>稿件写作中</td>\n';
                            }else if(json[i].complete == "2"){
                                content += '<td>稿件完成</td>\n';
                            }else if(json[i].complete == "3"){
                                content += '<td>稿件送审中</td>\n';
                            }else if(json[i].complete == "4"){
                                content += '<td>稿件已录用</td>\n';
                            }else if(json[i].complete == "5"){
                                content += '<td>稿件待出刊</td>\n';
                            }else{
                                content += '<td>稿件已出刊</td>\n';
                            }
                        }
                        content += '<td class="am-hide-sm-only">' + json[i].username +'</td>' +
                            '<td>' + json[i].usertel + '</td>' +
                            '<td class="am-hide-sm-only">' + json[i].price + '</td>';
                        if(json[i].flag == "0"){
                            content += '<td class="shenhe">已付款</td>';
                        }else if(json[i].flag == "1"){
                            content += '<td class="shenhe">未付款</td>';
                        }else{
                            content += '<td class="shenhe">待审核</td>';
                        }

                        if(json[i].service == "2" || json[i].service == "4"){
                            content += '<td>' + json[i].fatime + '</td>';
                        }else{
                            content += '<td>' + json[i].ctime + '</td>';
                        }
                        if(json[i].service == "1" || json[i].service == "3"){
                            content += '<td>\n' +
                                '        <div class="am-btn-toolbar">\n' +
                                '            <div class="am-btn-group am-btn-group-xs">\n' +
                                '                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-secondary edit"><span class="am-icon-pencil-square-o"></span> 编辑</button>\n' +
                                '                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-success pay"><span class="am-icon-cny"></span>付款</button>\n' +
                                '                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-warning check"><span class="am-icon-check"></span>审核</button>\n' +
                                '                <div class="am-dropdown doc-dropdown-js">\n' +
                                '                                                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-primary am-dropdown-toggle" data-am-dropdown-toggle>\n' +
                                '                                                    <span class="am-icon-caret-down"></span>项目进度\n' +
                                '                                                </button>\n' +
                                '                                                <ul class="am-dropdown-content">\n' +
                                '                                                    <li><a href="javascript;" class="schedule1" value="0" onclick="return false">项目未开工</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule1" value="1" onclick="return false">项目开工</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule1" value="2" onclick="return false">完成初稿</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule1" value="3" onclick="return false">修改反馈</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule1" value="4" onclick="return false">项目完成</a></li>\n' +
                                '                                                </ul>\n' +
                                '                                            </div>\n' +
                                '                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-danger  delete"><span class="am-icon-trash-o"></span> 删除</button>\n' +
                                '            </div>\n' +
                                '        </div>\n' +
                                '    </td>' +
                                '</tr>';
                        }else if(json.service == "2"){
                            content += '<td>\n' +
                                '        <div class="am-btn-toolbar">\n' +
                                '            <div class="am-btn-group am-btn-group-xs">\n' +
                                '                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-secondary edit"><span class="am-icon-pencil-square-o"></span> 编辑</button>\n' +
                                '                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-success pay"><span class="am-icon-cny"></span>付款</button>\n' +
                                '                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-warning check"><span class="am-icon-check"></span>审核</button>\n' +
                                '                <div class="am-dropdown doc-dropdown-js">\n' +
                                '                                                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-primary am-dropdown-toggle" data-am-dropdown-toggle>\n' +
                                '                                                    <span class="am-icon-caret-down"></span>项目进度\n' +
                                '                                                </button>\n' +
                                '                                                <ul class="am-dropdown-content">\n' +
                                '                                                    <li><a href="javascript;" class="schedule2" value="0" onclick="return false">稿件未送审</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule2" value="1" onclick="return false">稿件送审中</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule2" value="2" onclick="return false">稿件已录用</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule2" value="3" onclick="return false">稿件待出刊</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule2" value="4" onclick="return false">稿件已出刊</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule2" value="5" onclick="return false">稿件返修</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule2" value="6" onclick="return false">退稿</a></li>\n' +
                                '                                                </ul>\n' +
                                '                                            </div>\n'+
                                '                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-danger  delete"><span class="am-icon-trash-o"></span> 删除</button>\n' +
                                '            </div>\n' +
                                '        </div>\n' +
                                '    </td>' +
                                '</tr>';
                        }else{
                            content += '<td>\n' +
                                '        <div class="am-btn-toolbar">\n' +
                                '            <div class="am-btn-group am-btn-group-xs">\n' +
                                '                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-secondary edit"><span class="am-icon-pencil-square-o"></span> 编辑</button>\n' +
                                '                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-success pay"><span class="am-icon-cny"></span>付款</button>\n' +
                                '                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-warning check"><span class="am-icon-check"></span>审核</button>\n' +
                                '                <div class="am-dropdown doc-dropdown-js">\n' +
                                '                                                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-primary am-dropdown-toggle" data-am-dropdown-toggle>\n' +
                                '                                                    <span class="am-icon-caret-down"></span>项目进度\n' +
                                '                                                </button>\n' +
                                '                                                <ul class="am-dropdown-content">\n' +
                                '                                                    <li><a href="javascript;" class="schedule3" value="0" onclick="return false">项目未开工</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule3" value="1" onclick="return false">稿件写作中</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule3" value="2" onclick="return false">稿件完成</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule3" value="3" onclick="return false">稿件送审中</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule3" value="4" onclick="return false">稿件已录用</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule3" value="5" onclick="return false">稿件待出刊</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule3" value="6" onclick="return false">稿件已出刊</a></li>\n' +
                                '                                                </ul>\n' +
                                '                                            </div>\n'+
                                '                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-danger  delete"><span class="am-icon-trash-o"></span> 删除</button>\n' +
                                '            </div>\n' +
                                '        </div>\n' +
                                '    </td>' +
                                '</tr>';
                        }
                    }
                    $(".or").append(content);
                    $('.doc-dropdown-js').dropdown({justify: '.doc-dropdown-justify-js'});
                }
            })
        })
        $('#nav').on("change", "#rateType", function () {
            var id = $('#selectType').val();
            var oid = $('#orderType').val();
            var rid = $('#rateType').val();
            $.ajax({
                type: "POST",
                url: "{:url('table/order_list')}",
                data: {"id":id, "oid":oid, "rid":rid},
                dataType: "json",
                success:function (data) {
                    var json = eval(data);
                    var content = "";
                    $(".or").empty();
                    $(".am-cf").empty();
                    for(var i=0;i<json.length;i++){
                        b = i + 1;
                        content +=
                            '<tr>' +
                            '<td><input type="checkbox"></td>' +
                            '<td>' + b + '</td>' +
                            '<td class="order"><a href="{:url(\'table/order_list_detail\',[\'order\' => $vo.order])}">' + json[i].order +'</a></td>' +
                            '<td>' + json[i].title + '</td>';
                        if(json[i].service == "1"){
                            content += '<td>文稿代写</td>';
                            if(json[i].complete == "0"){
                                content += '<td>项目未开工</td>\n';
                            }else if(json[i].complete == "1"){
                                content += '<td>项目开工</td>\n';
                            }else if(json[i].complete == "2"){
                                content += '<td>完成初稿</td>\n';
                            }else if(json[i].complete == "3"){
                                content += '<td>修改反馈</td>\n';
                            }else{
                                content += '<td>项目完成</td>\n';
                            }
                        }else if(json[i].service == "2"){
                            content += '<td>期刊发表</td>';
                            if(json[i].complete == "0"){
                                content += '<td>稿件未送审</td>\n';
                            }else if(json[i].complete == "1"){
                                content += '<td>稿件送审中</td>\n';
                            }else if(json[i].complete == "2"){
                                content += '<td>稿件已录用</td>\n';
                            }else if(json[i].complete == "3"){
                                content += '<td>稿件待出刊</td>\n';
                            }else if(json[i].complete == "4"){
                                content += '<td>稿件已出刊</td>\n';
                            }else if(json[i].complete == "5"){
                                content += '<td>稿件返修</td>\n';
                            }else{
                                content += '<td>退稿</td>\n';
                            }
                        }else if(json[i].service == "3"){
                            content += '<td>论文修改</td>';
                            if(json[i].complete == "0"){
                                content += '<td>项目未开工</td>\n';
                            }else if(json[i].complete == "1"){
                                content += '<td>项目开工</td>\n';
                            }else if(json[i].complete == "2"){
                                content += '<td>完成初稿</td>\n';
                            }else if(json[i].complete == "3"){
                                content += '<td>修改反馈</td>\n';
                            }else{
                                content += '<td>项目完成</td>\n';
                            }
                        }else{
                            content += '<td>包写包发</td>';
                            if(json[i].complete == "0"){
                                content += '<td>项目未开工</td>\n';
                            }else if(json[i].complete == "1"){
                                content += '<td>稿件写作中</td>\n';
                            }else if(json[i].complete == "2"){
                                content += '<td>稿件完成</td>\n';
                            }else if(json[i].complete == "3"){
                                content += '<td>稿件送审中</td>\n';
                            }else if(json[i].complete == "4"){
                                content += '<td>稿件已录用</td>\n';
                            }else if(json[i].complete == "5"){
                                content += '<td>稿件待出刊</td>\n';
                            }else{
                                content += '<td>稿件已出刊</td>\n';
                            }
                        }
                        content += '<td class="am-hide-sm-only">' + json[i].username +'</td>' +
                            '<td>' + json[i].usertel + '</td>' +
                            '<td class="am-hide-sm-only">' + json[i].price + '</td>';
                        if(json[i].flag == "0"){
                            content += '<td class="shenhe">已付款</td>';
                        }else if(json[i].flag == "1"){
                            content += '<td class="shenhe">未付款</td>';
                        }else{
                            content += '<td class="shenhe">待审核</td>';
                        }

                        if(json[i].service == "2" || json[i].service == "4"){
                            content += '<td>' + json[i].fatime + '</td>';
                        }else{
                            content += '<td>' + json[i].ctime + '</td>';
                        }
                        if(json[i].service == "1" || json[i].service == "3"){
                            content += '<td>\n' +
                                '        <div class="am-btn-toolbar">\n' +
                                '            <div class="am-btn-group am-btn-group-xs">\n' +
                                '                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-secondary edit"><span class="am-icon-pencil-square-o"></span> 编辑</button>\n' +
                                '                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-success pay"><span class="am-icon-cny"></span>付款</button>\n' +
                                '                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-warning check"><span class="am-icon-check"></span>审核</button>\n' +
                                '                <div class="am-dropdown doc-dropdown-js">\n' +
                                '                                                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-primary am-dropdown-toggle" data-am-dropdown-toggle>\n' +
                                '                                                    <span class="am-icon-caret-down"></span>项目进度\n' +
                                '                                                </button>\n' +
                                '                                                <ul class="am-dropdown-content">\n' +
                                '                                                    <li><a href="javascript;" class="schedule1" value="0" onclick="return false">项目未开工</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule1" value="1" onclick="return false">项目开工</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule1" value="2" onclick="return false">完成初稿</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule1" value="3" onclick="return false">修改反馈</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule1" value="4" onclick="return false">项目完成</a></li>\n' +
                                '                                                </ul>\n' +
                                '                                            </div>\n' +
                                '                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-danger  delete"><span class="am-icon-trash-o"></span> 删除</button>\n' +
                                '            </div>\n' +
                                '        </div>\n' +
                                '    </td>' +
                                '</tr>';
                        }else if(json.service == "2"){
                            content += '<td>\n' +
                                '        <div class="am-btn-toolbar">\n' +
                                '            <div class="am-btn-group am-btn-group-xs">\n' +
                                '                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-secondary edit"><span class="am-icon-pencil-square-o"></span> 编辑</button>\n' +
                                '                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-success pay"><span class="am-icon-cny"></span>付款</button>\n' +
                                '                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-warning check"><span class="am-icon-check"></span>审核</button>\n' +
                                '                <div class="am-dropdown doc-dropdown-js">\n' +
                                '                                                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-primary am-dropdown-toggle" data-am-dropdown-toggle>\n' +
                                '                                                    <span class="am-icon-caret-down"></span>项目进度\n' +
                                '                                                </button>\n' +
                                '                                                <ul class="am-dropdown-content">\n' +
                                '                                                    <li><a href="javascript;" class="schedule2" value="0" onclick="return false">稿件未送审</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule2" value="1" onclick="return false">稿件送审中</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule2" value="2" onclick="return false">稿件已录用</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule2" value="3" onclick="return false">稿件待出刊</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule2" value="4" onclick="return false">稿件已出刊</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule2" value="5" onclick="return false">稿件返修</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule2" value="6" onclick="return false">退稿</a></li>\n' +
                                '                                                </ul>\n' +
                                '                                            </div>\n'+
                                '                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-danger  delete"><span class="am-icon-trash-o"></span> 删除</button>\n' +
                                '            </div>\n' +
                                '        </div>\n' +
                                '    </td>' +
                                '</tr>';
                        }else{
                            content += '<td>\n' +
                                '        <div class="am-btn-toolbar">\n' +
                                '            <div class="am-btn-group am-btn-group-xs">\n' +
                                '                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-secondary edit"><span class="am-icon-pencil-square-o"></span> 编辑</button>\n' +
                                '                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-success pay"><span class="am-icon-cny"></span>付款</button>\n' +
                                '                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-warning check"><span class="am-icon-check"></span>审核</button>\n' +
                                '                <div class="am-dropdown doc-dropdown-js">\n' +
                                '                                                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-primary am-dropdown-toggle" data-am-dropdown-toggle>\n' +
                                '                                                    <span class="am-icon-caret-down"></span>项目进度\n' +
                                '                                                </button>\n' +
                                '                                                <ul class="am-dropdown-content">\n' +
                                '                                                    <li><a href="javascript;" class="schedule3" value="0" onclick="return false">项目未开工</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule3" value="1" onclick="return false">稿件写作中</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule3" value="2" onclick="return false">稿件完成</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule3" value="3" onclick="return false">稿件送审中</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule3" value="4" onclick="return false">稿件已录用</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule3" value="5" onclick="return false">稿件待出刊</a></li>\n' +
                                '                                                    <li><a href="javascript;" class="schedule3" value="6" onclick="return false">稿件已出刊</a></li>\n' +
                                '                                                </ul>\n' +
                                '                                            </div>\n'+
                                '                <button type="button" class="am-btn am-btn-default am-btn-xs am-text-danger  delete"><span class="am-icon-trash-o"></span> 删除</button>\n' +
                                '            </div>\n' +
                                '        </div>\n' +
                                '    </td>' +
                                '</tr>';

                        }
                    }
                    $(".or").append(content);
                    $('.doc-dropdown-js').dropdown({justify: '.doc-dropdown-justify-js'});
                }
            })
        })
    </script>
    <script type="text/javascript">
        //编辑按钮事件
        $('.or').on('click', '.edit', function () {
            var order = $(this).parent().parent().parent().parent().children('.order').text();
            url = "{:url('table/order_list_detail')}";
            str = url + '?order=' +order;
            window.location.href=str;
        })

        //付款按钮事件
        $('.or').on('click', '.pay', function () {
            var order = $(this).parent().parent().parent().parent().children('.order').text();
            var pay = $(this).parent().parent().parent().parent().children('.shenhe');
            $.ajax({
                type:"POST",
                url:"{:url('table/pay')}",
                data: {"order":order},
                dataType: "json",
                success:function (data) {
                    if(data != 0){
                        pay.empty();
                        alert("付款成功！");
                        var content = "已付款";
                        pay.append(content);
                    }else{
                        alert("该订单已经付款了，请勿再点击付款按钮！");
                    }
                }
            })
        })

        //审核按钮事件
        $('.or').on('click', '.check', function () {
            var order = $(this).parent().parent().parent().parent().children('.order').text();
            var shenhe = $(this).parent().parent().parent().parent().children('.shenhe');
            $.ajax({
                type:"POST",
                url:"{:url('table/check')}",
                data: {"order":order},
                dataType: "json",
                success:function (data) {
                    if(data != 0){
                        shenhe.empty();
                        alert("审核成功！");
                        var content = "未付款";
                        shenhe.append(content);
                    }else{
                        alert("已审核了，请勿重复审核!");
                        return false;
                    }
                }
            })
        })
        //文稿代写或论文修改项目进度按钮事件
        $(".or").on("click", ".schedule1", function () {
            var id = $(this).attr('value');
            var order = $(this).parent().parent().parent().parent().parent().parent().parent().children('.order').text();
            $.ajax({
                type: "post",
                url: "{:url('table/schedule')}",
                data: {"id":id, "order":order},
                dataType: "json",
                success:function (data) {
                    if(data != 0 ){
                        alert("项目进度更改成功！");
                        window.location.reload();
                    }else{
                        alert("项目进度更改失败！");
                        return false;
                    }
                }
            });
        })

        //期刊发表项目进度按钮事件
        $(".or").on("click", ".schedule2", function () {
            var id = $(this).attr('value');
            var order = $(this).parent().parent().parent().parent().parent().parent().parent().children('.order').text();
            $.ajax({
                type: "post",
                url: "{:url('table/schedule')}",
                data: {"id":id, "order":order},
                dataType: "json",
                success:function (data) {
                    if(data != 0 ){
                        alert("项目进度更改成功！");
                        window.location.reload();
                    }else{
                        alert("项目进度更改失败！");
                        return false;
                    }
                }
            });
        })

        //包写包发项目进度按钮事件
        $(".or").on("click", ".schedule3", function () {
            var id = $(this).attr('value');
            var order = $(this).parent().parent().parent().parent().parent().parent().parent().children('.order').text();
            $.ajax({
                type: "post",
                url: "{:url('table/schedule')}",
                data: {"id":id, "order":order},
                dataType: "json",
                success:function (data) {
                    if(data != 0 ){
                        alert("项目进度更改成功！");
                        window.location.reload();
                    }else{
                        alert("项目进度更改失败！");
                        return false;
                    }
                }
            });
        })

        //删除按钮事件
        $('.or').on('click', '.delete', function () {
            var order = $(this).parent().parent().parent().parent().children('.order').text();
            $.ajax({
                type:"POST",
                url:"{:url('table/delete')}",
                data: {"order":order},
                dataType: "json",
                success:function (data) {
                    if(data == 1){
                        window.location.reload();
                    }else{
                        alert("订单删除失败!");
                    }
                }
            })
        })

    </script>
</div>
{include file="public/footer"}